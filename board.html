<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>이주영 홈페이지</title>
  <link rel="stylesheet" href="css/reset.css" />
  <link rel="stylesheet" href="css/cmmn.css" />
  <link rel="stylesheet" href="css/head.css" />
  <link rel="stylesheet" href="css/header.css" />
  <link rel="stylesheet" href="css/body.css" />
  <link rel="stylesheet" href="css/section.css" />
</head>

<body>
  <header>
    <h1>Hello World!</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="">About</a>
      <a href="board.html">Notice</a>
      <a href="">Gallery</a>
      <a href="">Contact</a>
      <a href="">Login</a>
    </nav>
  </header>
  <div class="wrapper">
    <table>
      <colgroup>
        <col class="no">
        <col class="title">
        <col class="date">
      </colgroup>
      <thead>
        <tr>
          <th class="mobile-hide">번호</th>
          <th id="th-title">제목</th>
          <th class="mobile-hide">날짜</th>
        </tr>
      </thead>
      <tbody>
          <!--
          <tr>
            <td class="mobile-hide">1</td>
            <td><a href="#">글의 제목 - 1</a></td>
            <td class="mobile-hide">2019.10.14</td>
          </tr>
          <tr>
            <td class="mobile-hide">2</td>
            <td><a href="#">글의 제목 - 2</a></td>
            <td class="mobile-hide">2019.10.14</td>
          </tr>
          <tr>
            <td class="mobile-hide">3</td>
            <td><a href="#">글의 제목 - 3</a></td>
            <td class="mobile-hide">2019.10.14</td>
          </tr>
          -->
      </tbody>
    </table>
    <div class="page-box">
      <a class="btn" href="#">&lt;&lt;</a>
      <a class="btn" href="#">&lt;</a>

      <!--  숫자 버튼  -->
      <a class="btn number" href="#">1</a>
      <a class="btn number" href="#">2</a>
      <a class="btn number on" href="#">3</a>
      <a class="btn number" href="#">4</a>
      <a class="btn number" href="#">5</a>

      <a class="btn" href="#">&gt;</a>
      <a class="btn" href="#">&gt;&gt;</a>
    </div>
  </div>
</body>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script>
  $(function () {
    $(window).scroll(function () {
      var winTop = $(window).scrollTop();
      if (winTop >= 30) {
        $("body").addClass("sticky-header");
      } else {
        $("body").removeClass("sticky-header");
      }
    });

    board('B003');
  });

  $('.check.all').on('change', function () {
    $('.check').prop('checked', $(this).prop('checked'));
  });

  $(document).on('click', '.page-box .btn.number', function () {
    $('.page-box .btn.number').removeClass('on');
    $(this).addClass('on');
    return false;
  })
  function formattedDate(str) {
    let date = new Date(str);
    let year = date.getFullYear();
    let month = date.getMonth() + 1;
    let day = date.getDate();
    let result = `${year}.${month}.${day}`;

    return result;
  }
  function board(code) {
    let searchData = {
      code : code,
      // page : 2,
      search : ''
    };

    $.ajax({
      type: 'GET',
      url: encodeURI('http://localhost/board/list'),
      dataType: 'text',
      data: searchData,
      contentType : 'application/json',
      success: (data) => {
        data = JSON.parse(data);
        let status = data.status;
        let message = data.message;

        if(status != '200') {
          alert(message);
          return;
        }

        let pagination = data.data.pagination;
        let searchData = data.data.searchData;
        let result = data.data.result;

        // console.log('pagination = ', pagination);
        // console.log('searchData = ', searchData);
        // console.log('result = ', result);

        let html = null;

        result.forEach((item, idx) => {
          // console.log('idx = ', idx, ' item = ', item);
          let api_url = 'http://127.0.0.1/';
          let date = formattedDate(item.createdAt);

          html += `<tr>
                    <td class="mobile-hide">${item.rowNumber}</td>
                    <td><a href="${api_url}board/detail/${item.iboard}">${item.title}</a></td>
                    <td class="mobile-hide">${date}</td>
                  </tr>`;
        });

        $('table tbody').append(html);
      },
      error: (error, status, errorThrown) => {
        console.log('fail-data        : ', error);
        console.log('fail-status      : ', status);
        console.log('fail-errorThrown : ', errorThrown);
      }
    })
  }
</script>

</html>